<div class="nav-icon"></div>
<a class="link login-button" href="contribute-login.html"></a>
<!--<a class="link" href="partners.html">Partners</a>-->
<a class="link" href="http://data.openaddresses.io">Data</a>
<a class="link contribute-link" href="contribute-login.html">Contribute</a>
<a class="link" href="mailto:openaddresses@gmail.com">Contact</a>
<div class="logout-button">Logout</div>

<script>
    var logoutTimeout;
    
    if (localStorage.hello || localStorage.token) {
        var base = 'https://api.github.com/';
        var auth;
        if (localStorage.hello) auth = '?access_token=' + JSON.parse(localStorage.hello).github.access_token;
        else auth = '?access_token=' + localStorage.token;
        
        jQuery.get(base + 'user' + auth, function (data) {
            $('.login-button').css({
                'background-image': 'url(\'' + data.avatar_url + '\')',
                'background-size': '40px 40px'
            });
            $('.login-button').attr("href", "contribute.html");
            $('.login-button').addClass('logout');
            $('.contribute-link').attr("href", "contribute.html");
                       
            $('.logout').hover ( function() {
                $('.logout-button').css('display', 'block');
            }, function() {
                logoutTimeout = setTimeout(function() {
                    $('.logout-button').css('display', 'none');
                }, 200);
            });
        });
    }
    
    $('.logout-button').hover (
        function() {
            clearTimeout(logoutTimeout);
        }, function() {
            $('.logout-button').css('display', 'none');
        }
    );

    $('.logout-button').click(function() {
        delete localStorage.hello;
        delete localStorage.token;
        location.href="./index.html"
    });
</script>
